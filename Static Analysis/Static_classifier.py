from sklearn import tree
from sklearn.model_selection import train_test_split
import pandas as pd
import numpy as np
import pickle



dat = pd.read_csv("Features.csv", sep = ',', header = 0)
data = dat.sample(frac = 1)
data.head()


y = np.array(data.iloc[:,53])
x = np.array(data.iloc[:,:53])

kf = ms.KFold(n_splits = 5,random_state = None, shuffle = True)
for train_index, test_index in kf.split(x) :
	X_train, X_test = x[train_index],x[test_index]
	Y_train, Y_test = y[train_index],y[test_index]
	cl = tree.DecisionTreeClassifier()
	cl = cl.fit(X_train,Y_train)
	print(cl.score(X_test,Y_test))

cln = tree.DecisionTreeClassifier()
cln = cln.fit(x,y)

pickle.dump(cln,open('model.txt','wb'))

test = pd.read_csv("Test.csv", sep = ',', header = 0)
da = test.sample(frac = 1)
da.head()

Yy = np.array(da.iloc[:,53])
Xx= np.array(da.iloc[:,:53])

load_model = pickle.load(open('model.txt','rb'))
result = load_model.predict(Xx)


print(result)
print(Yy)
