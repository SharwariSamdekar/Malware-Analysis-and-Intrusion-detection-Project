#python3 code to find set of Dlls in both benign and malware files

import os
import re

regex = '\w+\.dll+\.+\w+\s'



# def main() :
# 	print(os.listdir("ABC"))



def main():
	listdll = list()
	basepath = 'Malware concatenated/'
	count = 0
	cd = os.getcwd()
	for file in os.listdir(basepath) :
		if os.path.isdir(os.path.join(basepath,file)) :
			dirn = os.path.join(basepath,file)
			# print(dirn)
			ndir = os.chdir(dirn)
			# print(os.getcwd())
			for files in os.listdir(ndir) :
				if(files == "Structure_Info.txt"):
					# print(count)
					count = count + 1
					f = open(files, encoding = "utf8",errors = "ignore")
					fread = f.read()
					listdll.extend(re.findall(regex,fread))
					# s = set(listdll)
					# print(s)
			os.chdir(cd)
	print(set(listdll))
	print(len(listdll))


# Driver Code 
if __name__ == '__main__': 
      
    # Calling main() function 
    main() 
