import os
import json

def main() :
	listfeat = set()
	cd = os.getcwd()
	basepath = 'Malware Concatenated/'
	new = os.chdir(basepath)
	for jfs in os.listdir(new) :
		with(open(jfs,'r')) as f :
			file = json.load(f)
			try :
				count = 0
				for items in file['behavior']['apistats'] :
					m = int(items)
					if m >= count :
						count = m
					# print(count)
				for item in file['behavior']['apistats'][str(count)] :
					# print("adding",item)
					listfeat.add(item)
			except KeyError as ke :
				continue
	os.chdir(cd)
	path = 'Benign/'
	newd = os.chdir(path)
	for jf in os.listdir(newd) :
		with(open(jf,'r')) as b :
			fileb = json.load(b)
			try :
				count = 0
				for items in fileb['behavior']['apistats'] :
					m = int(items)
					if m >= count :
						count = m
					# print(count)
				for item in fileb['behavior']['apistats'][str(count)] :
					# print("adding",item)
					listfeat.add(item)
			except KeyError as ke :
				continue
	print(listfeat)

# Driver Code 
if __name__ == '__main__': 
      
    # Calling main() function 
    main() 
